# M2.3 - Frontend Hosting

## Task Description

**What**: Azure Static Web Apps configuration for the React frontend.

**Why**:
- Static hosting is simpler and cheaper than server-rendered
- CDN ensures fast loading from any location
- Automatic HTTPS (required for microphone access)

## TDD Requirements

### Test File: `tests/test_frontend_build.py`

Write these tests FIRST:

```python
import subprocess
import json
from pathlib import Path

def test_package_json_has_build_script():
    """Frontend has build script."""
    with open("frontend/package.json") as f:
        pkg = json.load(f)

    assert "build" in pkg.get("scripts", {}), "No build script"

def test_frontend_builds_successfully():
    """Frontend production build succeeds."""
    result = subprocess.run(
        ["npm", "run", "build"],
        cwd="frontend",
        capture_output=True, text=True
    )
    assert result.returncode == 0, f"Build failed: {result.stderr}"

def test_build_output_exists():
    """Build creates dist directory."""
    # Run build first
    subprocess.run(["npm", "run", "build"], cwd="frontend", check=True)

    dist = Path("frontend/dist")
    assert dist.is_dir(), "No dist directory"
    assert (dist / "index.html").exists(), "No index.html"

def test_static_web_app_config_exists():
    """Static Web Apps configuration exists."""
    config_path = Path("frontend/staticwebapp.config.json")
    assert config_path.exists()

    with open(config_path) as f:
        config = json.load(f)

    # Should have navigation fallback for SPA
    assert "navigationFallback" in config

def test_build_size_reasonable():
    """Build output is under 10MB."""
    subprocess.run(["npm", "run", "build"], cwd="frontend", check=True)

    total_size = sum(
        f.stat().st_size
        for f in Path("frontend/dist").rglob("*")
        if f.is_file()
    )
    size_mb = total_size / (1024**2)
    assert size_mb < 10, f"Build too large: {size_mb:.2f}MB"
```

## Verification Command

```bash
pytest tests/test_frontend_build.py -v
```

## Completion Promise

Only output this when ALL tests pass:

```
<promise>M2.3 COMPLETE</promise>
```

## Dependencies

- M2.2 (Backend Infrastructure)

## Files to Create/Modify

- `frontend/staticwebapp.config.json`
- `tests/test_frontend_build.py`
